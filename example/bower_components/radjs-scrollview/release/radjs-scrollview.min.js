!function(t,i){if("function"==typeof define&&define.amd)define("radjs-scrollview",["radjs-pointer","radjs-gesture"],function(s,e){t.RADJS_ScrollView=i(s,e);return t.RADJS_ScrollView});else if("object"==typeof module&&module.exports){t.RADJS_ScrollView=i(require("radjs-pointer"),require("radjs-gesture"));module.exports=t.RADJS_ScrollView}else t.RADJS_ScrollView=i(t.PointerTracker||t.RADJS_Pointer,t.GestureTracker||t.RADJS_Gesture)}(this,function(t,i){"use strict";function s(t){function i(t){return t.charAt(0).toUpperCase()+t.slice(1)}var s,e=["webkit","moz","ms","o"],o=document.createElement("div"),n=t.toLowerCase(),a=[];for(s=0;s<e.length;s+=1)a.push(e[s]+i(t));for(s=0;s<a.length;s+=1)if(void 0!==o.style[a[s]]){n="-"+e[s]+"-"+t;break}return n}function e(t,i){var s;for(s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);return t}function o(t,i){i=e({className:"scrollbar",direction:"vertical"},i);this.direction=i.direction;this._container=t;this._bar=document.createElement("div");this._bar.style.position="absolute";this._bar.className=i.className;this._bar.style.opacity=0;this._container.appendChild(this._bar);this._containerSize=0;this._position=0;this._max=0;this._translateArray="vertical"===this.direction?["translate3d(0, ",0,"px, 0)"]:["translate3d(",0,"px, 0, 0)"]}!function(t){t.Date.now||(t.Date.now=function(){return+new Date})}(window);!function(t){t.performance||(t.performance={});t.performance.now&&(t.performance.now=performance.webkitNow||performance.mozNow||performance.msNow||performance.oNow||function(){return Date.now()})}(window);!function(t){for(var i=0,s=["webkit","moz","ms","o"],e=0;e<s.length&&!t.requestAnimationFrame;++e){t.requestAnimationFrame=t[s[e]+"RequestAnimationFrame"];t.cancelAnimationFrame=t[s[e]+"CancelAnimationFrame"]||t[s[e]+"CancelRequestAnimationFrame"]}t.requestAnimationFrame||(t.requestAnimationFrame=function(s){var e=Date.now(),o=Math.max(0,16-(e-i)),n=t.setTimeout(function(){s(e+o)},o);i=e+o;return n});t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}(window);o.prototype={_transformName:s("transform"),_transitionName:s("transition"),setPosition:function(t){this._position=t;this._translateArray[1]=-t*this._containerSize/this._max;this._translateArray[1]<=0?this._translateArray[1]=0:this._translateArray[1]>=this._containerSize&&(this._translateArray[1]=this._containerSize);this._bar.style[this._transformName]=this._translateArray.join("")},refresh:function(t){var i=this;this._max=t;this._bar.style.opacity=0===Math.max(0,t)?0:1;if("vertical"===this.direction){this._bar.style.height=this._container.offsetHeight*(this._container.offsetHeight/(t+this._container.offsetHeight))+"px";this._containerSize=this._container.offsetHeight-this._bar.offsetHeight}else{this._bar.style.width=this._container.offsetWidth*(this._container.offsetWidth/(t+this._container.offsetWidth))+"px";this._containerSize=this._container.offsetWidth-this._bar.offsetWidth}this._bar.style[this._transitionName]="transform 300ms";this.setPosition(this._position);setTimeout(function(){i._bar.style[i._transitionName]="transform 0ms"},350)}};var n=function(){function t(t,i){var s,o,n,a=this;this._options=e({preventMove:!0,resizeEvent:!0,scroll:!0,bounds:!1,direction:"vertical",marginMIN:0,marginMAX:0,onScroll:function(t){},onScrollBefore:function(t){return!0},onScrollAfter:function(){},onScrollTypeChange:function(t){}},i);if("vertical"===this._options.direction){this._transitionArray=["translate3d(0, ",0,"px, 0)"];this._coordName="screenY";this._speedName="speedY"}else{this._transitionArray=["translate3d(",0,"px, 0, 0)"];this._coordName="screenX";this._speedName="speedX"}this._animParams=null;this._RafID=null;this._lastPointerPosition=0;this._shift=0;this._motionType=this._lastMotionType=this._STRINGS.stop;this._isMoved=!1;this._tmp={shift:0,now:0,easing:0,velocity:0};this._pos=0;this._root=t;this._wrapper=t.firstElementChild;s=["fixed","relative","absolute"];o=s.indexOf(window.getComputedStyle(t,null).position);-1===o&&(o=s.indexOf(t.style.position));this._root.style.position=-1===o?"relative":s[o];this._root.style.overflow="hidden";this._wrapper.style.margin=0;this._wrapper.style.position="absolute";this._wrapper.style[this._transitionName]="transform 0ms";for(n in this.TRACKING_EVENTS)this.TRACKING_EVENTS.hasOwnProperty(n)&&this._root.addEventListener(this.TRACKING_EVENTS[n],this,!1);this._options.resizeEvent&&window.addEventListener(this.TRACKING_EVENTS.resize,this,!1);this._animationStep=function(t){if(a._options.scroll){a._calculateShift(t);a._pos-=a._shift;if(a._motionType!==a._STRINGS.tweak||a._motionType!==a._STRINGS.stop){if(a._pos<a._min-a._margine){a._pos=a._min-a._margine;a._motionType=a._STRINGS.checkTweak}if(a._pos>a._margine+a._max){a._pos=a._margine+a._max;a._motionType=a._STRINGS.checkTweak}}if(0!==a._shift)if(a._isMoved||a._options.onScrollBefore(a._shift)){a._isMoved=!0;a._options.onScroll(a._shift,a._pos);if(a._lastMotionType!==a._motionType&&a._motionType!==a._STRINGS.checkTweak&&a._motionType!==a._STRINGS.stop){a._options.onScrollTypeChange(a._motionType);a._lastMotionType=a._motionType}}else a._motionType=a._STRINGS.stop;a._transitionArray[1]=a._pos;if(a._motionType===a._STRINGS.stop){a._transitionArray[1]=Math.round(a._transitionArray[1]);a._isMoved&&a._options.onScrollAfter();a._isMoved=!1}else a._RafID=window.requestAnimationFrame(a._animationStep);a._wrapper.style[a._transformName]=a._transitionArray.join("");a._shift=0}};this.refresh()}t.prototype={TRACKING_EVENTS:{resize:"resize",up:"pointerup",move:"pointermove",down:"pointerdown",chancel:"pointercancel",fling:"fling"},_STRINGS:{tweak:"tweak",checkTweak:"checkTweak",stop:"stop",scroll:"scroll",fling:"fling",move:"move"},_transitionName:s("transition"),_transformName:s("transform"),_calculateShift:function(t){if(null===this._animParams.startTime){this._animParams.startTime=t;this._animParams.lastTime=t}switch(this._motionType){case this._STRINGS.move:this._shift/=this._pos<this._min||this._pos>this._max?3:1;break;case this._STRINGS.fling:this._shift=this._animParams.velocity*(t-this._animParams.lastTime);this._tmp.velocity=this._animParams.velocity+this._animParams.a*(t-this._animParams.startTime);if(this._tmp.velocity/this._animParams.velocity>0){this._animParams.velocity=this._tmp.velocity;if(this._pos<this._min&&this._animParams.velocity>0||this._pos>this._max&&this._animParams.velocity<0){this._animParams.velocity+=.6*-this._animParams.velocity;Math.abs(this._shift)<.1&&(this._motionType=this._STRINGS.checkTweak)}}else this._motionType=this._STRINGS.checkTweak;break;case this._STRINGS.tweak:case this._STRINGS.scroll:this._tmp.now=Math.ceil(1e3*(t-this._animParams.startTime)/this._animParams.duration)/1e3;this._tmp.easing=this.easeFunc(this._tmp.now);this._tmp.shift=Math.ceil(1e3*this._animParams.shift*this._tmp.easing)/1e3;if(0!==this._animParams.duration)this._shift=this._tmp.shift-this._animParams.lastShift;else{this._shift=this._animParams.shift;this._tmp.now=1}if(this._tmp.now>=1)if(this._motionType===this._STRINGS.tweak){this._shift=this._animParams.shift-this._animParams.lastShift;this._motionType=this._STRINGS.stop}else this._motionType=this._STRINGS.checkTweak;this._animParams.lastShift=this._tmp.shift;break;case this._STRINGS.checkTweak:this._tmp.shift=this._pos>this._max?this._max-this._pos:this._pos<this._min?this._min-this._pos:0;if(this._options.tweak&&0===this._tmp.shift&&this._pos<this._max&&this._pos>this._min){this._tmp.shift=this._pos-Math.ceil(1e3*Math.round(this._pos/this._options.tweak)*this._options.tweak)/1e3;this._tmp.shift=-this._tmp.shift}this._animParams={shift:-this._tmp.shift,lastShift:0,duration:250,startTime:t,lastTime:null};this._motionType=0!==this._tmp.shift?this._STRINGS.tweak:this._STRINGS.stop}this._animParams.lastTime=t;this._shift=isNaN(this._shift)?0:this._shift},_eventPointerDown:function(t){window.cancelAnimationFrame(this._RafID);this._lastPointerPosition=t[this._coordName];this._animParams={};this._motionType=this._STRINGS.move;this._RafID=window.requestAnimationFrame(this._animationStep)},_eventPointerMove:function(t){this._shift+=this._lastPointerPosition-t[this._coordName];this._lastPointerPosition=t[this._coordName]},_eventPointerUp:function(t){this._motionType!==this._STRINGS.fling&&(this._motionType=this._STRINGS.checkTweak);this._eventPointerMove(t)},_eventFling:function(t){var i=this._options.scroll?-t[this._speedName]:0;if(0!==i){this._animParams={velocity:i,a:9e-5*-(0>i?-1:1),startTime:null,lastTime:null};this._motionType=this._STRINGS.fling}},preventDefaultTags:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/,easeFunc:function(t){return t*(2-t)},destroy:function(){var t;for(t in this.TRACKING_EVENTS)this.TRACKING_EVENTS.hasOwnProperty(t)&&this._root.removeEventListener(this.TRACKING_EVENTS[t],this);window.removeEventListener(this.TRACKING_EVENTS.resize,this);window.cancelAnimationFrame(this._RafID);this._root=null;this._wrapper=null;this._options=null},refresh:function(){var t=this._root.offsetWidth,i=this._root.offsetHeight;window.cancelAnimationFrame(this._RafID);this._motionType=this._STRINGS.stop;if("vertical"===this._options.direction){this._min=i<=this._wrapper.clientHeight?i-this._wrapper.clientHeight-this._options.marginMAX:0;this._margine=this._options.bounds?Math.round(i/3):0}else{this._min=t<=this._wrapper.offsetWidth?t-this._wrapper.clientWidth-this._options.marginMAX:0;this._margine=this._options.bounds?Math.round(t/3):0}this._max=this._options.marginMIN;this._motionType=this._STRINGS.checkTweak;this._animParams={};this._RafID=window.requestAnimationFrame(this._animationStep)},scroll:function(t,i){var s,e,o=i;window.cancelAnimationFrame(this._RafID);this._motionType=this._STRINGS.stop;if(0!==t){e=this._pos+t;if(e<this._min){s=this._min-this._pos;o=Math.abs(Math.round(i*s/t));t=s}if(e>this._max){s=this._max-this._pos;o=Math.abs(Math.round(i*s/t));t=s}}t=this._options.scroll?t:0;this._motionType=this._STRINGS.scroll;this._animParams={shift:-t,lastShift:0,duration:o,startTime:null,lastTime:null};this._RafID=window.requestAnimationFrame(this._animationStep)},jumpTo:function(t){var i,s=0;if("string"==typeof t){i="%"===t.slice(-1)?1:0;s=parseFloat(t)}else if(t instanceof Element)i=2;else{i=0;s=parseFloat(t)}0>s&&(s=0);switch(i){case 0:var e=0;if("vertical"==this._options.direction){e=this._wrapper.offsetHeight-this._root.offsetHeight;s>e&&(s=e);s=-1*parseInt(s);this._wrapper.style[this._transformName]="translate3d(0, "+s+"px, 0)"}else{e=this._wrapper.offsetWidth;s>e&&(s=e);s=parseInt(s);this._wrapper.style[this._transformName]="translate3d("+s+"px, 0, 0)"}break;case 1:break;case 2:}},handleEvent:function(t,i){var s=this;switch(t.type){case this.TRACKING_EVENTS.down:if("function"==typeof this._options.onDownBefore&&!i&&this._options.onDownBefore(t)===!1)return;this._eventPointerDown(t);"function"!=typeof this._options.onDownAfter||i||this._options.onDownAfter(t);break;case this.TRACKING_EVENTS.move:if("function"==typeof this._options.onMoveBefore&&!i&&this._options.onMoveBefore(t)===!1)return;this._eventPointerMove(t);this._options.preventMove&&!this.preventDefaultTags.test(t.target)&&t.preventDefault();"function"!=typeof this._options.onMoveAfter||i||this._options.onMoveAfter(t);break;case this.TRACKING_EVENTS.cancel:if("function"==typeof this._options.onCancelBefore&&!i&&this._options.onCancelBefore(t)===!1)return;this._eventPointerUp(t);"function"!=typeof this._options.onCancelAfter||i||this._options.onCancelAfter(t);break;case this.TRACKING_EVENTS.up:if("function"==typeof this._options.onUpBefore&&!i&&this._options.onUpBefore(t)===!1)return;this._eventPointerUp(t);"function"!=typeof this._options.onUpAfter||i||this._options.onUpAfter(t);break;case this.TRACKING_EVENTS.fling:if("function"==typeof this._options.onFlingBefore&&!i&&this._options.onFlingBefore(t)===!1)return;this._eventFling(t);"function"!=typeof this._options.onFlingAfter||i||this._options.onFlingAfter(t);break;case this.TRACKING_EVENTS.resize:if("function"==typeof this._options.onResizeBefore&&!i&&this._options.onResizeBefore(t)===!1)return;clearTimeout(this._resizeID);var e=this;this._resizeID=setTimeout(function(){s.refresh();"function"!=typeof e._options.onResizeAfter||i||e._options.onResizeAfter(t)},250)}}};t.ScrollBar=o;return t}();return n});
//# sourceMappingURL=radjs-scrollview.min.js.map